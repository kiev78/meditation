<div class="settings-container">
  <h2>Settings</h2>

  <!-- Bell Configuration Section -->
  <section class="settings-section">
    <h3>Bell Configuration</h3>

    <div class="bell-config-container">

      <!-- Interval Bells -->
      <div class="control-row">
        <mat-label>Interval Bells (sound the bell every x minutes)</mat-label>
        <div class="slider-input-group">
          <mat-slider min="0" max="60" step=".5" [disabled]="isRunning" class="slider">
            <input
              matSliderThumb
              [(ngModel)]="intervalMinutes"
              (ngModelChange)="updateIntervalMinutes()"
            />
          </mat-slider>
          <span class="value-display">{{ intervalMinutes }}</span>
        </div>
      </div>

      <!-- Start Bells -->
      <div class="bell-section">
        <div class="count-column">
           <div class="control-row">
            <mat-label>How many starting bells:</mat-label>
            <div class="slider-input-group">
              <mat-slider min="0" max="10" step="1" [disabled]="isRunning" class="slider">
                <input
                  matSliderThumb
                  [(ngModel)]="startBells"
                  (valueChange)="onStartBellsChange($event)"
                />
              </mat-slider>
              <span class="value-display">{{ startBells }}</span>
            </div>
          </div>
        </div>

        <div class="intervals-column" *ngIf="startBellIntervals.length > 0">
          <h4>Intervals between starting bells</h4>
          <ng-container
            *ngFor="let interval of startBellIntervals; let i = index; trackBy: trackByIndex"
          >
            <div class="control-row">
              <mat-label>Interval {{ i + 1 }} (sec)</mat-label>
              <div class="slider-input-group">
                <mat-slider min="1" max="60" step="1" [disabled]="isRunning" class="slider">
                  <input
                    matSliderThumb
                    [(ngModel)]="startBellIntervals[i]"
                    (valueChange)="updateBellSettings()"
                  />
                </mat-slider>
                <span class="value-display">{{ startBellIntervals[i] }}s</span>
              </div>
            </div>
          </ng-container>
        </div>
      </div>

      <!-- End Bells -->
      <div class="bell-section">
        <div class="count-column">
          <div class="control-row">
            <mat-label>How many ending bells:</mat-label>
            <div class="slider-input-group">
              <mat-slider min="0" max="10" step="1" [disabled]="isRunning" class="slider">
                <input matSliderThumb [(ngModel)]="endBells" (valueChange)="onEndBellsChange($event)" />
              </mat-slider>
              <span class="value-display">{{ endBells }}</span>
            </div>
          </div>
        </div>

        <div class="intervals-column" *ngIf="endBellIntervals.length > 0">
          <h4>Intervals between ending bells</h4>
          <ng-container *ngFor="let interval of endBellIntervals; let i = index; trackBy: trackByIndex">
            <div class="control-row">
              <mat-label>Interval {{ i + 1 }} (sec)</mat-label>
              <div class="slider-input-group">
                <mat-slider min="1" max="60" step="1" [disabled]="isRunning" class="slider">
                  <input
                    matSliderThumb
                    [(ngModel)]="endBellIntervals[i]"
                    (valueChange)="updateBellSettings()"
                  />
                </mat-slider>
                <span class="value-display">{{ endBellIntervals[i] }}s</span>
              </div>
            </div>
          </ng-container>
        </div>
      </div>

    </div>
  </section>

  <!-- Background Image Section -->
  <section class="settings-section">
    <h3>Background Image</h3>

    <div class="form-group">
      <label>Source</label>
      <mat-radio-group [(ngModel)]="mode" aria-label="Select an option">
        <mat-radio-button value="url">URL</mat-radio-button>
        <mat-radio-button value="upload">Upload</mat-radio-button>
      </mat-radio-group>
    </div>

    @if(mode === 'url'){
    <div class="form-group url-input-group">
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Image URL</mat-label>
        <input
          matInput
          type="text"
          [(ngModel)]="backgroundImageUrl"
          placeholder="Enter image URL"
        />
      </mat-form-field>
      <button mat-raised-button color="primary" (click)="saveUrl()">Save URL</button>
    </div>
    } @if(mode === 'upload'){
    <div class="form-group">
      <input type="file" hidden (change)="onFileSelected($event)" #fileInput accept="image/*" />
      <button mat-raised-button (click)="fileInput.click()">
        <mat-icon>upload_file</mat-icon> Upload Image
      </button>
    </div>
    }

    <div class="action-buttons">
      <button mat-raised-button color="primary" (click)="clearBackground()">
        Clear Background
      </button>
      <button mat-raised-button color="primary" (click)="saveSettings()">Save Background</button>
    </div>
    @if(backgroundImageUrl){
    <div class="preview">
      <p>Current background:</p>
      <img [src]="backgroundImageUrl" alt="Background preview" />
    </div>
    }
  </section>
</div>
