<div class="guided-container">
  <div class="content">
    <h3>{{ title }}</h3>
    <p>
      <strong>{{ teacher }}</strong>
    </p>

    <div class="audio-controls">
      <div class="timeline-row">
        <span class="time-text">{{ formatTime(currentTime) }}</span>
        <mat-slider
          [min]="0"
          [max]="duration"
          step="1"
          [displayWith]="formatLabel"
          class="timeline-slider"
        >
          <input matSliderThumb [value]="currentTime" (change)="seek($event)" />
        </mat-slider>
        <span class="time-text">{{ formatTime(duration) }}</span>
      </div>
      <div class="button-row">
        <button mat-icon-button (click)="skip(-10)">
          <mat-icon>replay_10</mat-icon>
        </button>
        <button mat-fab color="primary" (click)="togglePlay($event)">
          <ng-container *ngIf="timerService.state$ | async as state">
            <ng-container [ngSwitch]="state.phase">
              <ng-template ngSwitchCase="paused">
                <mat-icon>play_arrow</mat-icon>
              </ng-template>
              <ng-template ngSwitchCase="stopped">
                <mat-icon>play_arrow</mat-icon>
              </ng-template>
              <ng-template ngSwitchCase="finished">
                <mat-icon>play_arrow</mat-icon>
              </ng-template>
              
              <ng-template ngSwitchCase="delay">
                  <span class="fab-countdown">{{ state.remainingTime }}</span>
              </ng-template>
              <ng-template ngSwitchCase="bells">
                  <mat-icon>notifications</mat-icon>
              </ng-template>
  
              <ng-template ngSwitchCase="meditation">
                  <mat-icon>pause</mat-icon>
              </ng-template>
            </ng-container>
          </ng-container>
        </button>
        <button mat-icon-button (click)="skip(10)">
          <mat-icon>forward_10</mat-icon>
        </button>
        <!-- Next Button triggers parent cycle -->
        <button mat-icon-button (click)="onNext()">
          <mat-icon>skip_next</mat-icon>
        </button>
      </div>
    </div>
  </div>
</div>
